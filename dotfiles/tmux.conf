# Prefix key ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

unbind C-b
set -g prefix C-r
bind-key C-r send-prefix

# Misc config ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

set -sg escape-time 0
set -g mouse on
set -g history-limit 30000
set -g default-terminal "screen-256color"
set -g set-clipboard off
set -g aggressive-resize on
set -g base-index 1
set -g pane-base-index 1
set -g status-interval 5
set -g renumber-windows on

# Theme ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

set -g status-style fg=brightwhite,bg=black
set -g message-style fg=black,bg=white

setw -g window-status-format "#[bg=magenta, fg=black] #{window_panes} #[bg=brightblack, fg=brightcyan] #(tmux-get-window-name \"#{pane_current_path}\") #{?window_zoomed_flag,^Z ,}"
setw -g window-status-current-format "#[bg=brightmagenta, fg=black] #{window_panes} #[bg=brightcyan, fg=black] #(tmux-get-window-name \"#{pane_current_path}\") #{?window_zoomed_flag,^Z ,}"

set -g status-left ""

set -g status-right "#[bg=brightblack, fg=white] #{=50:pane_title} #[bg=white, fg=black] %Y-%m-%d %H:%M "
set -g status-right-length 70

set -g window-style 'fg=colour247,bg=colour236'
set -g window-active-style 'fg=colour250,bg=black'

set -g pane-border-fg colour247
set -g pane-border-bg colour236
set -g pane-border-fg colour250
set -g pane-border-bg black

set -g pane-border-bg colour235
set -g pane-border-fg colour238
set -g pane-active-border-bg colour236
set -g pane-active-border-fg colour51

# Vim mode ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

bind-key y run-shell -b "tmux save-buffer - | copy"
bind-key v copy-mode
set -g mode-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-pipe-and-cancel "copy 2>/dev/null > /dev/null"
bind-key -T copy-mode-vi 'Y' send -X copy-pipe "copy 2>/dev/null > /dev/null" \; send -X clear-selection
bind-key -T copy-mode-vi 'h' send -X cursor-left
bind-key -T copy-mode-vi 'H' send -X start-of-line
bind-key -T copy-mode-vi 's' send -X cursor-right
bind-key -T copy-mode-vi 'S' send -X end-of-line
bind-key -T copy-mode-vi 't' send -X cursor-down
bind-key -T copy-mode-vi 'n' send -X cursor-up
bind-key -T copy-mode-vi 'T' send -X halfpage-down
bind-key -T copy-mode-vi 'N' send -X halfpage-up
bind-key -T copy-mode-vi 'l' send -X jump-to-forward
bind-key -T copy-mode-vi 'L' send -X jump-to-backward
bind-key -T copy-mode-vi 'j' send -X search-again
bind-key -T copy-mode-vi 'J' send -X search-reverse
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle
bind-key -T copy-mode-vi 'Escape' send -X cancel

# Key bindings ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

bind-key R source-file ~/.tmux.conf

bind-key h split-window -c '#{pane_current_path}' -hb
bind-key t split-window -c '#{pane_current_path}'
bind-key n split-window -c '#{pane_current_path}' -b
bind-key s split-window -c '#{pane_current_path}' -h

bind-key c new-window tmux-new-project-window
bind-key C new-window

bind-key g new-window tmux-update-git

bind-key -n C-g previous-window
bind-key -n C-l next-window
bind-key C-g send-keys C-g
bind-key C-l send-keys C-l
bind-key G swap-window -t {previous}
bind-key L swap-window -t {next}

bind-key -r < resize-pane -L 5
bind-key -r > resize-pane -R 5
bind-key -r + resize-pane -U 5
bind-key -r - resize-pane -D 5

# vim-tmux-navigator ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind-key -n C-t if-shell "$is_vim" "send-keys C-t"  "select-pane -D"
bind-key -n C-n if-shell "$is_vim" "send-keys C-n"  "select-pane -U"
bind-key -n C-s if-shell "$is_vim" "send-keys C-s"  "select-pane -R"
bind-key -T copy-mode-vi C-h select-pane -L
bind-key -T copy-mode-vi C-t select-pane -D
bind-key -T copy-mode-vi C-n select-pane -U
bind-key -T copy-mode-vi C-s select-pane -R
bind-key C-h send-keys C-h
bind-key C-t send-keys C-t
bind-key C-n send-keys C-n
bind-key C-s send-keys C-s
