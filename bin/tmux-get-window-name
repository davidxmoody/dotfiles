#!/bin/bash

sed_cmd=sed
type gsed 2>/dev/null >/dev/null && sed_cmd=gsed

$sed_cmd "
  s%^/$%ROOT%;
  s%^$HOME$%HOME%;
  s%^$TMP_DIR\\(/\\)\\?.*$%TMP\1%;
  s%^$P_DIR$%P_DIR%;
  s%^$P_DIR/\\([^/]\\+\\)\\(/\\)\\?.*$%\\U\\1\\2%;
  s%^/\\([^/]\\+\\)\\(/[^/]\\+\\)\\(/\\)\\?.*$%/\\1\\2\\3%;
" <<< "${1:-$PWD}"
