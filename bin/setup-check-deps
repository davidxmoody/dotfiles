#!/usr/bin/env bash

color_reset="\x1B[0m"
color_bad="\x1B[31m"
color_good="\x1B[32m"

echo_good() {
  echo -e "${color_good}☑ ${@}${color_reset}"
}

echo_bad() {
  echo -e "${color_bad}☐ ${@}${color_reset}"
}

check_installed() {
  local command=$1
  local find_version=$2
  local package=$3

  if type "$command" > /dev/null 2> /dev/null; then
    echo_good "$command" "$(bash -c "$find_version" | sed 's/^v//')"
  else
    echo_bad "$command" "$package"
  fi
}

echo "# homebrew"
check_installed bash "echo ${BASH_VERSION%%\(*}"
check_installed git "git --version 2> /dev/null | sed 's/git version //'"
check_installed python "python --version 2>&1 | grep -o '[0-9.]\+'"
check_installed python3 "python3 --version | grep -o '[0-9.]\+'"
echo

echo "# editing"
check_installed nvim "nvim --version | head -n1 | grep -o 'v[0-9.]\+'"
check_installed rg "" "(brew install ripgrep)"
check_installed fzf "" "(brew install fzf)"
check_installed tmux "" "(brew install tmux)"
check_installed sed "sed --version 2>&1 | head -n1 | grep -o '(GNU sed)'"
echo

echo "# tools"
check_installed xargs
check_installed watch
check_installed jq
check_installed tree
check_installed http
echo

echo "# node"
check_installed n
check_installed node "node --version 2> /dev/null"
check_installed npm "npm --version 2> /dev/null"
check_installed diff-so-fancy
check_installed eslint_d
check_installed http-server
check_installed jsonlint
check_installed ramda
check_installed tsc
check_installed tslint
echo
